# Configuration Overview

This document provides a detailed explanation of the structure and options used in this NixOS configuration repository.


## Flake Structure

The root `flake.nix` defines inputs for various channels such as `nixpkgs`, `home-manager`, `stylix` and others. Two main NixOS configurations are declared:

- **laptop** – targets laptops with modules imported from `hardware-configuration-laptop.nix` and user specific settings defined in `home-laptop.nix`.
- **desktop** – desktop configuration using `hardware-configuration-desktop.nix` with user settings from `home-desktop.nix`.

Each configuration pulls in common modules like `configuration.nix`, GPU configuration files, and Home Manager.

## Core System Configuration (`configuration.nix`)

This file is the heart of the system configuration. Key areas include:

1. **Imports** – brings in other modules such as custom packages from `packages.nix`.
2. **Hardware & Virtualization** – enables virtualbox, libvirtd, Logitech device support, Bluetooth, and more. ZRAM swap is also activated.
3. **Boot Settings** – systemd-boot with EFI support, kernel modules (e.g., `v4l2loopback`), and plymouth splash.
4. **Security** – enabling policykit and realtime kit.
5. **Networking** – hostname, firewall defaults, wireless support, and NetworkManager.
6. **Locale & Time** – timezone `Europe/Paris` with English locales.
7. **Console and X11** – keeps the French keyboard layout while the system language is English.
8. **Fonts** – installs a selection of fonts including JetBrains Mono and Noto packages.
9. **Users** – defines `laptop`, `desktop`, and `sinusbot` users with group memberships.
10. **Nix Settings** – allows unfree packages, sets flake registry, and configures nix path.
11. **Environment** – sets global environment variables and enables Zsh.
12. **Services** – enables Flatpak, Udisks2, Emacs daemon, and XDG portals.
13. **Programs** – Hyprland, KDE Connect, Gamemode, Yazi file manager with custom keymap, CoreCtrl for hardware control, and more.
14. **Audio** – uses Pipewire with PulseAudio disabled.
15. **Stylix** – manages desktop theming and fonts.
16. **System Maintenance** – placeholder for garbage collection settings.
17. **State Version** – system.stateVersion is set to `23.05`.

## Home Manager Modules

User environments are managed with Home Manager:

- `home-desktop.nix` – sets up the `desktop` user, including Git configuration, Neovim setup, OBS Studio plugins, and window manager configuration from `wm-desktop`.
- `home-laptop.nix` – similar for the `laptop` user but with different package selections and window manager settings from `wm-laptop`.

Both import shared modules under `hm/` such as Zsh, Neovim, and VSCode configurations.

## Hardware Configuration Files

- `hardware-configuration.nix` – base hardware config used by default.
- `hardware-configuration-desktop.nix` – disk and device setup for the desktop machine, including multiple mount points.
- `hardware-configuration-laptop.nix` – laptop-specific disk layout and modules.

These files are generated by `nixos-generate-config` and describe filesystems, swap devices, and DHCP settings.

## GPU Modules

Two optional modules configure graphics drivers:

- `amdgpu.nix` – loads the AMD GPU driver, sets Vulkan packages, and exposes 32‑bit libraries.
- `nvidiagpu.nix` – enables proprietary NVIDIA drivers with options like power management and nvidia-settings.

## Package Collection (`packages.nix`)

Custom package definitions and system-wide packages are declared here. Highlights include:

- Enabling programs such as Steam, Java, and numerous multimedia tools.
- Large list of utilities ranging from audio tools, terminal utilities, to gaming enhancements.
- Overrides for themes like Catppuccin GTK.

To add your own packages, edit `packages.nix` directly. Packages pulled from the
main channel are organized into several `pkgs2_*` lists near the top of the
file. Append your desired package to the appropriate group (or create a new
group) and it will be included when all lists are concatenated into
`environment.systemPackages`. Packages that should come from the alternate
`pkgs-stable` channel go into the `stablepkgs` list defined above those groups.

## Additional Modules

- `droidcam.nix` and `v4l2loopback-dc.nix` – provide DroidCam and its kernel module.
- `python.nix` – defines a set of Python packages using `pkgs.python3.withPackages`.
- `ollama.nix` – builds the Ollama AI application with optional ROCm or CUDA support.


---

This documentation aims to serve as a reference for understanding and extending the configuration.
